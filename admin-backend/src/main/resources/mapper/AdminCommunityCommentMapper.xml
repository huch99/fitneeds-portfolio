<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.app.community.mapper.AdminCommunityCommentMapper">

  <!-- ADMIN 댓글 목록 조회 (전체 조회) -->
  <select id="selectCommentsByPostIdPaged"
          resultType="com.project.app.community.dto.CommunityCommentDto">
    SELECT
      comment_id      AS commentId,
      post_id         AS postId,
      writer_id       AS writerId,
      writer_type     AS writerType,
      content,
      created_at      AS createdAt,
      comment_visible AS commentVisible
    FROM community_comment
    WHERE post_id = #{postId}
    ORDER BY comment_id DESC
  </select>

  <!-- ADMIN 댓글 전체 개수 -->
  <select id="selectCommentCountByPostId" resultType="int">
    SELECT COUNT(*)
    FROM community_comment
    WHERE post_id = #{postId}
  </select>

  <!-- 숨김 / 보이기 -->
  <update id="updateCommentVisible">
    UPDATE community_comment
    SET comment_visible = #{commentVisible}
    WHERE comment_id = #{commentId}
  </update>

  <!-- 삭제 -->
  <delete id="deleteComment">
    DELETE FROM community_comment
    WHERE comment_id = #{commentId}
  </delete>

</mapper>
