<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.app.community.mapper.CommunityCommentMapper">

    <!--
        USER 댓글 목록 조회
        - 특정 게시글(postId)에 대한 댓글
        - 관리자에 의해 숨김 처리되지 않은 댓글만 조회
        - comment_visible = 1
    -->
    <select id="selectVisibleCommentsByPostId"
            parameterType="long"
            resultType="com.project.app.community.dto.CommunityCommentDto">

        SELECT
            comment_id    AS commentId,
            post_id       AS postId,
            writer_id     AS writerId,
            writer_type   AS writerType,
            content,
            created_at    AS createdAt
        FROM community_comment
        WHERE post_id = #{postId}
          AND comment_visible = 1
        ORDER BY comment_id ASC

    </select>

</mapper>
